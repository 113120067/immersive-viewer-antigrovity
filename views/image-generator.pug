extends layout

block content
  .container-fluid.mt-4
    .row
      .col-md-8
        // ä¸»è¦ç”Ÿæˆå€åŸŸ
        .card
          .card-header.bg-primary.text-white
            h4.mb-0 ğŸ¨ AI Image Generator - DALL-E
          .card-body
            // ä½¿ç”¨è€…è³‡è¨Š
            .alert.alert-info.mb-4#userInfo(style="display: none")
              strong ğŸ‘¤ Welcome, <span id="userEmail">Loading...</span>
              p.mb-0.small Generate amazing images with AI. Please use responsibly.
            
            // åœ–ç‰‡ç”Ÿæˆè¡¨å–®
            form#imageGeneratorForm
              .mb-3
                label.form-label(for="promptInput") 
                  strong ğŸ“ Describe your image:
                textarea#promptInput.form-control(
                  rows="4" 
                  placeholder="A beautiful sunset over mountains with a lake in the foreground, digital art style"
                  maxlength="4000"
                  required
                )
                .form-text Character count: <span id="charCount">0</span>/<span id="maxChars">2000</span>
              
              // æä¾›å•†é¸æ“‡
              .mb-3
                label.form-label(for="providerSelect") ğŸ¤– AI Provider:
                select#providerSelect.form-select
                  option(value="") Auto (Best Available)
                  option(value="pollinations") ğŸŒ¸ Pollinations (Free)
                  option(value="azure-openai") ğŸ”· Azure OpenAI DALL-E
                  option(value="google-imagen") ğŸŸ¢ Google Imagen
                .form-text Select a specific AI provider or let the system choose automatically
              
              // Pollinations é¸é …
              .pollinations-options.mb-3(style="display: none")
                h6.text-info ğŸŒ¸ Pollinations Options (Free)
                .row
                  .col-md-4
                    label.form-label(for="pollinationsWidthSelect") ğŸ“ Width:
                    select#pollinationsWidthSelect.form-select
                      option(value="512") 512px
                      option(value="768") 768px
                      option(value="1024" selected) 1024px
                  
                  .col-md-4
                    label.form-label(for="pollinationsHeightSelect") ğŸ“ Height:
                    select#pollinationsHeightSelect.form-select
                      option(value="512") 512px
                      option(value="768") 768px
                      option(value="1024" selected) 1024px
                  
                  .col-md-4
                    label.form-label(for="pollinationsModelSelect") ğŸ­ Model:
                    select#pollinationsModelSelect.form-select
                      option(value="flux" selected) Flux (Default)
                      option(value="flux-realism") Flux Realism
                      option(value="flux-anime") Flux Anime
                      option(value="flux-3d") Flux 3D
                
                .row.mt-2
                  .col-md-6
                    label.form-label(for="pollinationsSeedInput") ğŸ² Seed (Optional):
                    input#pollinationsSeedInput.form-control(type="number" placeholder="Random seed for reproducible results")
                  
                  .col-md-6.d-flex.align-items-end
                    .form-check
                      input#pollinationsEnhanceCheck.form-check-input(type="checkbox" checked)
                      label.form-check-label(for="pollinationsEnhanceCheck") âœ¨ Enhance Prompt
                
                .alert.alert-info.mt-2
                  i.fas.fa-info-circle.me-2
                  | Pollinations is completely free with unlimited usage!
              
              // Azure OpenAI é¸é …
              .azure-options.mb-3(style="display: none")
                h6.text-primary ğŸ”· Azure OpenAI Options
                .row
                  .col-md-4
                    label.form-label(for="sizeSelect") ğŸ“ Size:
                    select#sizeSelect.form-select
                      option(value="1024x1024") Square (1024Ã—1024)
                      option(value="1792x1024") Landscape (1792Ã—1024)
                      option(value="1024x1792") Portrait (1024Ã—1792)
                  
                  .col-md-4
                    label.form-label(for="qualitySelect") ğŸ¯ Quality:
                    select#qualitySelect.form-select
                      option(value="standard") Standard
                      option(value="hd") HD (Higher cost)
                  
                  .col-md-4
                    label.form-label(for="styleSelect") ğŸ­ Style:
                    select#styleSelect.form-select
                      option(value="vivid") Vivid (More creative)
                      option(value="natural") Natural (More realistic)
              
              // Google Imagen é¸é …
              .google-options.mb-3(style="display: none")
                h6.text-success ğŸŸ¢ Google Imagen Options
                .row
                  .col-md-4
                    label.form-label(for="aspectRatioSelect") ğŸ“ Aspect Ratio:
                    select#aspectRatioSelect.form-select
                      option(value="1:1") Square (1:1)
                      option(value="16:9") Landscape (16:9)
                      option(value="9:16") Portrait (9:16)
                      option(value="4:3") Standard (4:3)
                      option(value="3:4") Portrait (3:4)
                  
                  .col-md-4
                    label.form-label(for="outputFormatSelect") ğŸ–¼ï¸ Format:
                    select#outputFormatSelect.form-select
                      option(value="image/jpeg") JPEG
                      option(value="image/png") PNG
                  
                  .col-md-4
                    label.form-label(for="seedInput") ğŸ² Seed (Optional):
                    input#seedInput.form-control(type="number" placeholder="Random seed")
              
              .d-grid
                button#generateBtn.btn.btn-primary.btn-lg(type="submit")
                  i.fas.fa-magic
                  |  Generate Image
            
            // ç”Ÿæˆç‹€æ…‹
            .mt-4#generationStatus(style="display: none")
              .alert.alert-info
                .d-flex.align-items-center
                  .spinner-border.spinner-border-sm.me-2
                  span Generating your image... This may take 10-30 seconds.
            
            // éŒ¯èª¤è¨Šæ¯
            .mt-3#errorMessage(style="display: none")
              .alert.alert-danger
                i.fas.fa-exclamation-triangle.me-2
                span#errorText
      
      .col-md-4
        // çµæœå’Œæ­·å²å€åŸŸ
        .card
          .card-header.bg-success.text-white
            h5.mb-0 ğŸ–¼ï¸ Generated Image
          .card-body
            // åœ–ç‰‡é¡¯ç¤ºå€åŸŸ
            .image-result.mb-3#imageResult(style="display: none")
              .text-center
                img#generatedImage.img-fluid.rounded(style="max-width: 100%; height: auto")
                .mt-2
                  small.text-muted#revisedPrompt
                .mt-2
                  .provider-info#providerInfoMain(style="display: none")
                    small.text-success
                      strong ğŸ¤– Generated by: 
                      span#providerName
                .mt-2
                  button.btn.btn-outline-info.btn-sm#showPromptBtn(type="button" style="display: none")
                    | ğŸ¤– Show AI Prompt
                .mt-2
                  a#downloadLink.btn.btn-outline-primary.btn-sm(download="ai-generated-image.png")
                    i.fas.fa-download.me-1
                    | Download Image
            
            // ä½”ä½ç¬¦
            .placeholder-content#placeholderContent
              .text-center.text-muted.py-5
                i.fas.fa-image.fa-3x.mb-3
                p Your generated image will appear here
            
            // æç¤ºè©é¡¯ç¤ºå€åŸŸ
            .prompt-info.mt-3#promptInfo(style="display: none")
              .bg-light.p-3.rounded.border
                h6.text-primary ğŸ¤– AI Prompt Used
                .small#promptContent(style="font-family: monospace; white-space: pre-wrap; max-height: 200px; overflow-y: auto")
                .mt-2
                  button.btn.btn-outline-secondary.btn-sm#hidePromptBtn(type="button")
                    | âœ–ï¸ Hide Prompt
            
            // ä½¿ç”¨çµ±è¨ˆ
            .usage-stats.mt-4
              h6 ğŸ“Š Usage Statistics
              .small.text-muted#usageStats
                | Loading statistics...

  // æ¨£å¼
  style.
    .image-result img {
      border: 2px solid #dee2e6;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }
    
    .placeholder-content {
      border: 2px dashed #dee2e6;
      border-radius: 8px;
      background-color: #f8f9fa;
    }
    
    #promptInput {
      resize: vertical;
      min-height: 100px;
    }
    
    .spinner-border-sm {
      width: 1rem;
      height: 1rem;
    }
    
    .usage-stats {
      background-color: #f8f9fa;
      padding: 15px;
      border-radius: 8px;
      border: 1px solid #dee2e6;
    }

block scripts
  script(src="/js/image-generator.js" type="module")
  script.
    // åˆå§‹åŒ–é é¢
    document.addEventListener('DOMContentLoaded', function() {
      console.log('ğŸ¨ Image Generator page loaded');
    });