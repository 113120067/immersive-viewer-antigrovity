extends layout

block content
  .container-fluid.mt-4
    .row
      .col-md-8
        // ä¸»è¦ç”Ÿæˆå€åŸŸ
        .card
          .card-header.bg-success.text-white
            h4.mb-0 ğŸ“š English Vocabulary Image Generator
          .card-body
            // ä½¿ç”¨è€…è³‡è¨Š
            .alert.alert-info.mb-4#userInfo(style="display: none")
              strong ğŸ‘¤ Welcome, <span id="userEmail">Loading...</span>
              p.mb-0.small Create memorable images to help students learn English vocabulary.
            
            // API ç‹€æ…‹æŒ‡ç¤ºå™¨
            .alert.alert-light.mb-3#apiStatus(style="display: none")
              .row.small
                .col-md-6
                  strong ğŸ¤– Available AI Providers:
                .col-md-6.text-end
                  span#providerStatus Loading...
            
            // å–®å­—è¼¸å…¥è¡¨å–®
            form#vocabularyForm
              .row
                .col-md-6
                  .mb-3
                    label.form-label(for="wordInput") 
                      strong ğŸ“ English Word:
                    input#wordInput.form-control(
                      type="text" 
                      placeholder="e.g., apple, running, beautiful"
                      required
                    )
                    .form-text Enter the English word you want to create a learning image for
                
                .col-md-6
                  .mb-3
                    label.form-label(for="definitionInput") 
                      strong ğŸ“– Definition (Optional):
                    input#definitionInput.form-control(
                      type="text" 
                      placeholder="e.g., a red fruit that grows on trees"
                    )
                    .form-text Help AI understand the specific meaning
              
              .row
                .col-md-3
                  .mb-3
                    label.form-label(for="providerSelect") ğŸ¤– AI Provider:
                    select#providerSelect.form-select
                      option(value="") Auto (Best Available)
                      option(value="azure-openai") ğŸ”· Azure OpenAI DALL-E
                      option(value="google-imagen") ğŸŸ¢ Google Imagen
                    .form-text Choose which AI to use
                
                .col-md-3
                  .mb-3
                    label.form-label(for="categorySelect") ğŸ“‚ Word Type:
                    select#categorySelect.form-select
                      option(value="auto") Auto Detect
                      option(value="noun") Noun (thing/person/place)
                      option(value="verb") Verb (action)
                      option(value="adjective") Adjective (description)
                      option(value="abstract") Abstract Concept
                
                .col-md-3
                  .mb-3
                    label.form-label(for="styleSelect") ğŸ¨ Image Style:
                    select#styleSelect.form-select
                      option(value="memory") Memory Aid (æ¸…æ™°æ•™è‚²é¢¨æ ¼)
                      option(value="cartoon" selected) Cartoon (å¡é€šé¢¨æ ¼)
                      option(value="contextual") Real Context (çœŸå¯¦æƒ…å¢ƒ)
                      option(value="story") Story Scene (æ•…äº‹å ´æ™¯)
                      option(value="conceptual") Concept Diagram (æ¦‚å¿µåœ–)
                
                .col-md-3
                  .mb-3
                    label.form-label(for="levelSelect") ğŸ¯ Student Level:
                    select#levelSelect.form-select
                      option(value="beginner" selected) Beginner (åˆå­¸è€…)
                      option(value="intermediate") Intermediate (ä¸­ç´š)
                      option(value="advanced") Advanced (é«˜ç´š)
              
              .row
                .col-md-6
                  .mb-3
                    label.form-label(for="techniqueSelect") ğŸ§  Memory Technique:
                    select#techniqueSelect.form-select
                      option(value="visual") Visual Impact (è¦–è¦ºè¡æ“Š)
                      option(value="association") Association (è¯æƒ³è¨˜æ†¶)
                      option(value="emotion") Emotional (æƒ…æ„Ÿè¨˜æ†¶)
                      option(value="story" selected) Story-based (æ•…äº‹è¨˜æ†¶)
                      option(value="contrast") Contrast (å°æ¯”è¨˜æ†¶)
                
                .col-md-6
                  .mb-3
                    .form-check.mt-4
                      input#includeTextCheck.form-check-input(type="checkbox")
                      label.form-check-label(for="includeTextCheck") 
                        | ğŸ“ Include word label in image
              
              // å¿«é€Ÿè¨­ç½®æŒ‰éˆ•
              .mb-3
                .row
                  .col-md-6
                    .small.text-muted Quick Settings:
                    .btn-group.flex-wrap(role="group")
                      button#resetDefaultBtn.btn.btn-outline-primary.btn-sm(type="button")
                        | ğŸ¯ Reset to Default
                      button#kidFriendlyBtn.btn.btn-outline-success.btn-sm(type="button")
                        | ğŸ‘¶ Kid Friendly
                      button#advancedBtn.btn.btn-outline-warning.btn-sm(type="button")
                        | ğŸ“ Advanced Mode
                  
                  .col-md-6
                    .small.text-muted Quick Examples:
                    .btn-group.flex-wrap(role="group")
                      button.btn.btn-outline-secondary.btn-sm(type="button" data-word="apple" data-definition="a round red or green fruit") Apple
                      button.btn.btn-outline-secondary.btn-sm(type="button" data-word="running" data-definition="moving quickly on foot") Running  
                      button.btn.btn-outline-secondary.btn-sm(type="button" data-word="happy" data-definition="feeling joy and pleasure") Happy
              
              .d-grid
                button#generateBtn.btn.btn-success.btn-lg(type="submit")
                  i.fas.fa-magic
                  |  Generate Learning Image
            
            // ç”Ÿæˆç‹€æ…‹
            .mt-4#generationStatus(style="display: none")
              .alert.alert-info
                .d-flex.align-items-center
                  .spinner-border.spinner-border-sm.me-2
                  span Creating your vocabulary learning image... This may take 10-30 seconds.
            
            // éŒ¯èª¤è¨Šæ¯
            .mt-3#errorMessage(style="display: none")
              .alert.alert-danger
                i.fas.fa-exclamation-triangle.me-2
                span#errorText
      
      .col-md-4
        // çµæœå’Œå»ºè­°å€åŸŸ
        .card
          .card-header.bg-primary.text-white
            h5.mb-0 ğŸ–¼ï¸ Learning Image
          .card-body
            // åœ–ç‰‡é¡¯ç¤ºå€åŸŸ
            .image-result.mb-3#imageResult(style="display: none")
              .text-center
                img#generatedImage.img-fluid.rounded(style="max-width: 100%; height: auto")
                .mt-2
                  .word-info.p-2.bg-light.rounded
                    h6.mb-1#wordTitle Word
                    small.text-muted#wordDefinition Definition
                .mt-2
                  small.text-muted#promptUsed
                .mt-2
                  a#downloadLink.btn.btn-outline-primary.btn-sm(download="vocabulary-image.png")
                    i.fas.fa-download.me-1
                    | Download Image
            
            // ä½”ä½ç¬¦
            .placeholder-content#placeholderContent
              .text-center.text-muted.py-4
                i.fas.fa-book-open.fa-3x.mb-3
                p Your vocabulary learning image will appear here
                small Try entering a word above!
            
            // ç³»çµ±æç¤ºè©é¡¯ç¤º
            .prompt-display.mt-4#promptDisplay(style="display: none")
              h6 ğŸ¤– AI Prompt Used
              .small.bg-light.p-3.rounded.border#promptText
                | The AI prompt will appear here...
              .mt-2
                button.btn.btn-outline-secondary.btn-sm#togglePrompt(type="button")
                  | ğŸ‘ï¸ Show/Hide Full Prompt
            
            // å­¸ç¿’å»ºè­°
            .learning-tips.mt-4
              h6 ğŸ’¡ Learning Tips
              .small.text-muted#learningTips
                ul
                  li Look at the image for 10-15 seconds
                  li Say the word out loud while viewing
                  li Create a sentence using the word
                  li Review the image again after 1 hour

        // å–®å­—æ­·å²
        .card.mt-3
          .card-header.bg-info.text-white
            h6.mb-0 ğŸ“‹ Recent Words
          .card-body
            .small#wordHistory
              p.text-muted No words generated yet

  // æ¨£å¼
  style.
    .image-result img {
      border: 2px solid #dee2e6;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }
    
    .placeholder-content {
      border: 2px dashed #dee2e6;
      border-radius: 8px;
      background-color: #f8f9fa;
    }
    
    .word-info {
      border: 1px solid #dee2e6;
    }
    
    .learning-tips {
      background-color: #f8f9fa;
      padding: 15px;
      border-radius: 8px;
      border: 1px solid #dee2e6;
    }
    
    .btn-group .btn {
      margin: 2px;
    }
    
    #wordHistory {
      max-height: 200px;
      overflow-y: auto;
    }
    
    .prompt-display {
      background-color: #f8f9fa;
      padding: 15px;
      border-radius: 8px;
      border: 1px solid #dee2e6;
    }
    
    .prompt-analysis {
      background-color: #e3f2fd;
      padding: 10px;
      border-radius: 5px;
      border-left: 4px solid #2196f3;
    }
    
    .prompt-breakdown .badge {
      font-size: 10px;
    }
    
    .bg-pink {
      background-color: #e91e63 !important;
    }
    
    .bg-purple {
      background-color: #9c27b0 !important;
    }
    
    #promptFull {
      max-height: 300px;
      overflow-y: auto;
    }
    
    .provider-info {
      background-color: #e8f5e8;
      padding: 10px;
      border-radius: 5px;
      border-left: 4px solid #28a745;
    }
    
    .provider-badge .badge {
      font-size: 14px;
    }

block scripts
  script(src="/js/vocabulary-generator.js" type="module")
  script.
    // åˆå§‹åŒ–é é¢
    document.addEventListener('DOMContentLoaded', function() {
      console.log('ğŸ“š Vocabulary Generator page loaded');
    });